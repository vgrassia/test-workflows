---
name: Test

on:
  push:
  workflow_dispatch:

jobs:
  test:
    name: Workflow Testing
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v1

    - name: Azure Login
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}

    - name: Azure CLI script
      id: retrieve-secrets
      uses: ./
      with:
        keyvault: "vgrassia-test-kv"
        secrets: "my-test-secret,
                  my-test-secret-2"

    - name: TEST STEP
      run: |
        echo "TEST VALUE: ${{ steps.retrieve-secrets.outputs.my-test-secret }}"
